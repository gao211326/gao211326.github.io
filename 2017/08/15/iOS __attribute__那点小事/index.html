<!DOCTYPE html>
<html lang="zh-Hans">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="One Dream" />



<meta name="description" content="今人不见古时月，今月曾经照古人  关于 attribute__attribute__机制虽然是GNU C的一大特色，但是在iOS中却也被广泛使用，随便举个例子 12345NS_CLASS_DEPRECATED_IOS(2_0, 9_0, &amp;quot;UIAlertView is deprecated. Use UIAlertController with a preferredStyle">
<meta name="keywords">
<meta property="og:type" content="article">
<meta property="og:title" content="iOS __attribute__那点小事">
<meta property="og:url" content="http://yoursite.com/2017/08/15/iOS __attribute__那点小事/index.html">
<meta property="og:site_name" content="半笑半醉间">
<meta property="og:description" content="今人不见古时月，今月曾经照古人  关于 attribute__attribute__机制虽然是GNU C的一大特色，但是在iOS中却也被广泛使用，随便举个例子 12345NS_CLASS_DEPRECATED_IOS(2_0, 9_0, &amp;quot;UIAlertView is deprecated. Use UIAlertController with a preferredStyle">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/2525768-369021a4d5494513.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/2525768-d6986c515d909079.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/2525768-3ac1ddb45f904085.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/2525768-4f402717348c1069.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/2525768-8bcd9cf345c0bb5a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/2525768-72411d9130e534b3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/2525768-098721470697ca66.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/2525768-63cb4820f332ddbc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/2525768-bb08e13ac4da17f1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/2525768-61889649b46383ff.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/2525768-62700bb1460cae13.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/2525768-1c1721a64e96a459.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/2525768-89701adff47037d1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/2525768-2e48c2e1d7eb98c0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/2525768-181ef703db6d290f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/2525768-4f2aaba3673bc49c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2017-08-15T07:46:56.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="iOS __attribute__那点小事">
<meta name="twitter:description" content="今人不见古时月，今月曾经照古人  关于 attribute__attribute__机制虽然是GNU C的一大特色，但是在iOS中却也被广泛使用，随便举个例子 12345NS_CLASS_DEPRECATED_IOS(2_0, 9_0, &amp;quot;UIAlertView is deprecated. Use UIAlertController with a preferredStyle">
<meta name="twitter:image" content="http://upload-images.jianshu.io/upload_images/2525768-369021a4d5494513.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="半笑半醉间" type="application/atom+xml">



    <link rel="shortcut icon" href="/favicon.png">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/orange/pace-theme-minimal.css" rel="stylesheet">


<link rel="stylesheet" href="/css/style.css">



<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>iOS __attribute__那点小事 | 半笑半醉间</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: undefined
    }
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/avatar.png" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">One Dream</a></h1>
        </hgroup>

        
        <p class="header-subtitle">人生为棋，我愿为卒，行动虽慢，可谁曾见我后退半步</p>
        

        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa GitHub" href="https://github.com/gao211326" title="GitHub"></a>
                            
                                <a class="fa 简书" href="http://www.jianshu.com/u/d772826c5def" title="简书"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" href="https://hexo.io">Hexo</a>
                    
                      <a class="main-nav-link switch-friends-link" href="https://pages.github.com/">GitHub</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://moxfive.xyz/">MOxFIVE</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">专注于前端</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">One Dream</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/avatar.png" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">One Dream</a></h1>
            </hgroup>
            
            <p class="header-subtitle">人生为棋，我愿为卒，行动虽慢，可谁曾见我后退半步</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/gao211326" title="GitHub"></a>
                            
                                <a class="fa 简书" target="_blank" href="http://www.jianshu.com/u/d772826c5def" title="简书"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="标签" friends="友情链接" about="关于我"/>
</nav>
      <div class="body-wrap"><article id="post-iOS __attribute__那点小事" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/08/15/iOS __attribute__那点小事/" class="article-date">
      <time datetime="2017-08-14T16:00:00.000Z" itemprop="datePublished">2017-08-15</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      iOS __attribute__那点小事
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        

        
        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <excerpt in="" index="" |="" 首页摘要="">


<blockquote>
<p>今人不见古时月，今月曾经照古人</p>
</blockquote>
<h5 id="关于-attribute"><a href="#关于-attribute" class="headerlink" title="关于 attribute"></a>关于 <strong>attribute</strong></h5><p><code>__attribute__</code>机制虽然是<code>GNU C</code>的一大特色，但是在<code>iOS</code>中却也被广泛使用，随便举个例子</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">NS_CLASS_DEPRECATED_IOS(2_0, 9_0, &quot;UIAlertView is deprecated. Use UIAlertController with a preferredStyle of UIAlertControllerStyleAlert instead&quot;) __TVOS_PROHIBITED</div><div class="line"></div><div class="line">#define NS_CLASS_DEPRECATED_IOS(_iosIntro, _iosDep, ...) NS_CLASS_DEPRECATED(NA, NA, _iosIntro, _iosDep, __VA_ARGS__)</div><div class="line"></div><div class="line">#define NS_CLASS_DEPRECATED(_mac, _macDep, _ios, _iosDep, ...) __attribute__((visibility(&quot;default&quot;))) NS_DEPRECATED(_mac, _macDep, _ios, _iosDep, __VA_ARGS__)</div></pre></td></tr></table></figure>
<a id="more"></a>
<the rest="" of="" contents="" |="" 余下全文="">

<p>上面是对<code>UIAlertView</code>的一个说明，大意是指<code>UIAlertView</code>在<code>iOS 2.0</code>被引入，在<code>iOS 9</code>废弃，但是废弃并不代表不能用，只是意味着我们应该开始考虑将相关代码迁移到新的<code>API</code>上面去了。看着这么多宏和其中的参数，有点懵，下面就来看看一些常用的属性。</p>
<h5 id="attribute-使用格式"><a href="#attribute-使用格式" class="headerlink" title="attribute 使用格式"></a><strong>attribute</strong> 使用格式</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">__attribute__(相关属性)</div></pre></td></tr></table></figure>
<h5 id="常用属性"><a href="#常用属性" class="headerlink" title="常用属性"></a>常用属性</h5><ul>
<li><code>availability</code>：使用版本、平台情况及相关说明信息</li>
<li><code>unavailable</code>：告诉编译器某方法不可用，如果强行调用编译器会提示错误</li>
<li><code>nonnull</code>：编译器对函数参数进行检查，不能为<code>null</code>，参数类型必须为指针类型（包括对象）</li>
<li><code>cleanup</code>：用于修饰一个变量，在它的作用域结束时可以自动执行一个指定的方法（用处挺大的）</li>
<li><code>objc_root_class</code>：顾名思义，表示我们这个类是一个基类</li>
<li><code>objc_designated_initializer</code>：指定类的初始化方法，并不是对使用者，而是对类内部的实现（具体可以看后面）</li>
<li><code>objc_requires_super</code>：表示子类在重新父类的方法的时候，必须先调用<code>super</code>方法，否则会有警告</li>
<li><code>objc_subclassing_restricted</code>：表示该类不能被继承</li>
<li><code>objc_runtime_name</code>：将类的名字在编译的时候改成另外的名字</li>
</ul>
<h5 id="具体使用"><a href="#具体使用" class="headerlink" title="具体使用"></a>具体使用</h5><h5 id="availability："><a href="#availability：" class="headerlink" title="availability："></a>availability：</h5><p>关于<code>availability</code>，我们先来看几个参数</p>
<ul>
<li><code>introduced</code>：引进的版本</li>
<li><code>deprecated</code>：废弃的版本，还能使用，并没有移除，而是提醒用户迁移到其他<code>API</code></li>
<li><code>obsoleted</code>：移除的版本，不能再使用</li>
<li><code>unavailable</code>：那些平台不能用</li>
<li><code>message</code>：额外提示信息，比如迁移到某某<code>API</code></li>
</ul>
<p>除了上面的参数外，需要指定支持或者不支持平台的时候，有两个值<code>ios</code>和<code>macosx</code></p>
<p>使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (void)testAvailability __attribute__((availability(ios,introduced=2_0,deprecated=7_0,obsoleted=11_0,message=&quot;将在ios11进行移除哦&quot;)));</div></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2525768-369021a4d5494513.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="availability.png"></p>
<p>该函数定义的时候，声明了支持平台、引进版本和废弃版本、移除版本，后面的<code>message</code>为提示信息，由于当前我所支持的版本为<code>iOS8</code>，所以会有警告，当改成<code>deprecated=9_0</code>，警告就会消失</p>
<p>下面在看一个关于<code>unavailable</code>的使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (void)testUnavailableAvailability __attribute__((availability(ios,unavailable,message=&quot;iOS平台你不能用的&quot;)));</div></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2525768-d6986c515d909079.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="unavailbaleAvai.png"></p>
<p>上面例子中，我们定义在<code>ios</code>平台不能用，如果强行使用就会报错，由于已经用了<code>unavailable</code>所以其它引进版本废弃版本移除版本参数均不能再添加到后面（可以试试）,会在声明函数的时候有警告<code>&quot;unavailable availability overrides all other availability infomation&quot;</code></p>
<h5 id="unavailable"><a href="#unavailable" class="headerlink" title="unavailable"></a>unavailable</h5><p>在系统中也有与其相关的宏定义</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">#if defined(__GNUC__) &amp;&amp; ((__GNUC__ &gt;= 4) || ((__GNUC__ == 3) &amp;&amp; (__GNUC_MINOR__ &gt;= 1)))</div><div class="line">    #define UNAVAILABLE_ATTRIBUTE __attribute__((unavailable))</div><div class="line">#else</div><div class="line">    #define UNAVAILABLE_ATTRIBUTE</div><div class="line">#endif</div><div class="line"></div><div class="line"></div><div class="line">#if !defined(NS_UNAVAILABLE)</div><div class="line">#define NS_UNAVAILABLE UNAVAILABLE_ATTRIBUTE</div><div class="line">#endif</div></pre></td></tr></table></figure>
<p>我们可以直接进行使用，比如下面这样</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">@interface TestModel : NSObject</div><div class="line"></div><div class="line">- (instancetype)init NS_UNAVAILABLE;</div><div class="line"></div><div class="line">- (instancetype)initWithSex:(NSString *)sex;</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2525768-3ac1ddb45f904085.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="bunengyong.png"></p>
<p>当然我们也可以直接使用<code>unavailable</code>，并且可以在后面追加一些参数提示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">@interface TestModel : NSObject</div><div class="line"></div><div class="line">- (instancetype)init NS_UNAVAILABLE;</div><div class="line"></div><div class="line">- (instancetype)initWithSex:(NSString *)sex;</div><div class="line"></div><div class="line">- (void)testModelAdd __attribute__((unavailable(&quot;这个方法无效了，你不能调用了&quot;)));</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2525768-4f402717348c1069.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="huangefangfa.png"></p>
<p>关于<code>unavailable</code>的使用，用处还是挺大的，比如我们自己建的一些类中，必须要让别人调用自己指定的初始化方法的时候，可以通过该方法来实现。</p>
<h5 id="nonnull"><a href="#nonnull" class="headerlink" title="nonnull"></a>nonnull</h5><p>指定参数不能为空，参数必须为制作类型，我们对上面的<code>TestModel</code>进行改造，如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (instancetype)initWithSex:(NSString *)sex address:(NSString *)address age:(NSInteger)age __attribute__((nonnull(1,2,3)));</div></pre></td></tr></table></figure>
<p>这里我们根据<code>1</code>、<code>2</code>、<code>3</code>来指定三个参数不能为空，但是我们最后一个参数，并不是指针类型，那是否有问题呢？来看看</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2525768-8bcd9cf345c0bb5a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="nonnull.png"></p>
<p>根据提示就知道，参数必须为指针类型</p>
<p>改成</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (instancetype)initWithSex:(NSString *)sex address:(NSString *)address age:(NSInteger)age __attribute__((nonnull(1,2)));</div></pre></td></tr></table></figure>
<p>表示前两个参数不能为空，使用情况</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2525768-72411d9130e534b3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="nonnul1.png"></p>
<p>当我们传入参数为空的时候，就会有警告信息</p>
<h5 id="cleanup"><a href="#cleanup" class="headerlink" title="cleanup"></a>cleanup</h5><p>前面我们说了用这个可以在作用域结束的时候执行指定的方法，下面我们就来仔细看看</p>
<p>其使用方式为 <code>__attribute__((cleanup(...)))</code>，先看个例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">	...</div><div class="line">	NSString *testCleanString __attribute__((cleanup(printTestString))) = @&quot;测试一下&quot;;</div><div class="line">&#125;</div><div class="line"></div><div class="line">void printTestString(NSString **string)&#123;</div><div class="line">        NSLog(@&quot; 打印信息string:%@&quot;,*string);</div><div class="line">&#125;</div><div class="line">//输出结果为</div><div class="line">打印信息string:测试一下</div></pre></td></tr></table></figure>
<p>其中 … 为我们定义的函数，注意这里的函数为<code>c</code>函数，且函数必须要带参数，而且参数为变量的地址，比如上面中的 <code>string</code>，我们传的是<code>**string</code>，这里的作用域为<code>{}</code>，那么还有那些作用域呢？比如：<code>return</code>，<code>break</code>，<code>goto</code>等。</p>
<p>当然我们还可以在自定义类型中进行使用，这一定会很有用</p>
<p>在上面<code>TestModel</code>类中，我们增加两个属性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">@interface TestModel : NSObject</div><div class="line"></div><div class="line">@property (nonatomic,copy) NSString *sex;</div><div class="line">@property (nonatomic,copy) NSString *address;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">	...</div><div class="line">	TestModel *testModel1 __attribute__((cleanup(testModelCleanUp))) = [[TestModel alloc] initWithSex:@&quot;男&quot; address:@&quot;四川成都&quot; age:1];</div><div class="line">  </div><div class="line">&#125;</div><div class="line"></div><div class="line">static void testModelCleanUp(__strong TestModel ** model)&#123;</div><div class="line">//    NSLog(@&quot; 打印信息+++++%s&quot;,*model.*sex);</div><div class="line">        NSLog(@&quot; 打印信息model:%@&quot;,*model);</div><div class="line">&#125;</div><div class="line">//输出结果</div><div class="line">打印信息model:&lt;TestModel: 0x608000030b40&gt;</div></pre></td></tr></table></figure>
<p>此处有个问题，我本来想通过该方法来输出<code>model</code> 里面的相关信息，然而尝试各种方法都没有实现（如果各位大神有办法，还望告知），为了实现目的，了解到将<code>block</code>作为参数传递进去，敬请看用法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line"> 		...</div><div class="line"> 		__strong void(^block)(void) __attribute__((cleanup(blockCleanUp), unused)) = ^&#123;</div><div class="line">        	NSLog(@&quot; 打印信息:%@ ++ %@&quot;,testModel1.sex,testModel1.address);</div><div class="line">    	&#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line">static void blockCleanUp(__strong void(^*block)(void)) &#123;</div><div class="line">    if (*block) &#123;</div><div class="line">        (*block)();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">//输出结果</div><div class="line">打印信息string:测试一下</div></pre></td></tr></table></figure>
<p>通过<code>block</code>终于可以输出想要的信息了，可见<code>block</code>带来的方便，说了这么多，那么<code>cleanup</code>到底什么时候用最好呢？比如有下面一个场景，定义一个对象，后面执行了许多其他操作，在这么多操作完成后需要对该对象进行处理，通常的办法就是在最后再对该对象进行处理，那么通过<code>cleanup</code>的话，我们就可以将改方法放到前面来执行，这样不管后面写多少，都不用担心啦…当然这这是其中一个简单的，其他更复杂的运用，估计只要在实践中实现了。</p>
<p>最后，还有个问题，就是当我们在同一个作用域有多个<code>cleanup</code>变量的时候，执行顺序又怎么样的呢？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line"> 	 NSString *testCleanString __attribute__((cleanup(printTestString))) = @&quot;测试一下&quot;;</div><div class="line">    </div><div class="line">    TestModel *testModel1 __attribute__((cleanup(testModelCleanUp))) = [[TestModel alloc] initWithSex:@&quot;男&quot; address:@&quot;四川成都&quot; age:1];</div><div class="line">//    [testModel1 testModelAdd];</div><div class="line"></div><div class="line">    __strong void(^block)(void) __attribute__((cleanup(blockCleanUp), unused)) = ^&#123;</div><div class="line">        NSLog(@&quot; 打印信息:%@ ++ %@&quot;,testModel1.sex,testModel1.address);</div><div class="line">    &#125;;</div><div class="line">&#125;</div><div class="line">//输出结果</div><div class="line">2017-08-14 17:12:38.810 Demo__For__attribute__[96180:6044949]  打印信息:男 ++ 四川成都</div><div class="line">2017-08-14 17:12:38.810 Demo__For__attribute__[96180:6044949]  打印信息model:&lt;TestModel: 0x608000030b40&gt;</div><div class="line">2017-08-14 17:12:38.811 Demo__For__attribute__[96180:6044949]  打印信息string:测试一下</div></pre></td></tr></table></figure>
<p>这下就全明白了吧，没错就是先入后出的的顺序</p>
<h5 id="objc-root-class"><a href="#objc-root-class" class="headerlink" title="objc_root_class"></a>objc_root_class</h5><p>这个表示该类是基类，比如<code>NSObject</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">OBJC_AVAILABLE(10.0, 2.0, 9.0, 1.0)</div><div class="line">OBJC_ROOT_CLASS</div><div class="line">OBJC_EXPORT</div><div class="line">@interface NSObject &lt;NSObject&gt; &#123;</div><div class="line">    Class isa  OBJC_ISA_AVAILABILITY;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h5 id="objc-designated-initializer"><a href="#objc-designated-initializer" class="headerlink" title="objc_designated_initializer"></a>objc_designated_initializer</h5><p>在《编写高质量iOS与OS X代码的52个有效方法》中有这么一节，提供全能初始化方法，当时是以<code>NSDate</code>来说明的，其初始化方法有如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">- (instancetype)init NS_DESIGNATED_INITIALIZER;//1</div><div class="line">- (instancetype)initWithTimeIntervalSinceReferenceDate:(NSTimeInterval)ti NS_DESIGNATED_INITIALIZER;//2</div><div class="line">- (nullable instancetype)initWithCoder:(NSCoder *)aDecoder NS_DESIGNATED_INITIALIZER;//3</div><div class="line"></div><div class="line">- (instancetype)initWithTimeIntervalSinceNow:(NSTimeInterval)secs;//4</div><div class="line">- (instancetype)initWithTimeIntervalSince1970:(NSTimeInterval)secs;//5</div><div class="line">- (instancetype)initWithTimeInterval:(NSTimeInterval)secsToBeAdded sinceDate:(NSDate *)date;//6</div></pre></td></tr></table></figure>
<p>我们抛开<code>1</code>和<code>3</code>方法不看，仔细查看<code>2、4、5、6</code>可以发现，<code>2</code>比其它方法多了一个<code>NS_DESIGNATED_INITIALIZER</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">#define NS_DESIGNATED_INITIALIZER __attribute__((objc_designated_initializer))</div></pre></td></tr></table></figure>
<p>没错，查看其宏定义，可以看到实际上就是<code>objc_designated_initializer</code>属性，方法<code>2</code>就是我们<code>NSDate</code>类的一个全能初始化方法，也就是说，其余的初始化方法在内部实现的时候都要调用该方法，切记是在类的内部实现，这样的话，我们就只需要在全能初始化方法中，进行数据存储，当我们底层数据存储机制改变的时候，只需要修改全能方法中的代码就可以了，而不用更改其他初始化方法。</p>
<p>下面我们就来看看<code>objc_designated_initializer</code>使用时需要注意的问题</p>
<p>我们先定义两个类<code>Anima</code>和<code>Dog</code>，并在其中加入一些初始化函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div></pre></td><td class="code"><pre><div class="line">@interface Anima : NSObject</div><div class="line"></div><div class="line">//指定为全能初始化函数</div><div class="line">- (instancetype)initWithName:(NSString *)name __attribute__((objc_designated_initializer));</div><div class="line"></div><div class="line">- (instancetype)initWithName:(NSString *)name age:(NSUInteger)age;</div><div class="line"></div><div class="line">- (instancetype)initWithName:(NSString *)name age:(NSUInteger)age sex:(NSString *)sex;</div><div class="line"></div><div class="line">@end</div><div class="line"></div><div class="line">#import &quot;Anima.h&quot;</div><div class="line"></div><div class="line">@implementation Anima</div><div class="line">//1</div><div class="line">- (instancetype)initWithName:(NSString *)name</div><div class="line">&#123;</div><div class="line">    self = [super init];</div><div class="line">    if (self) &#123;</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    return self;</div><div class="line">&#125;</div><div class="line"></div><div class="line">//2</div><div class="line">- (instancetype)initWithName:(NSString *)name age:(NSUInteger)age</div><div class="line">&#123;</div><div class="line">    self = [self initWithName:name];</div><div class="line">    if (self) &#123;</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    return self;</div><div class="line">&#125;</div><div class="line"></div><div class="line">//3</div><div class="line">- (instancetype)initWithName:(NSString *)name age:(NSUInteger)age sex:(NSString *)sex</div><div class="line">&#123;</div><div class="line">//    self = [self initWithName:name];</div><div class="line">//    self = [self initWithName:name age:age];</div><div class="line">    self = [super init];</div><div class="line">    </div><div class="line">    if (self) &#123;</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    return self;</div><div class="line">&#125;</div><div class="line"></div><div class="line">@end</div><div class="line"></div><div class="line"></div><div class="line">#import &quot;Anima.h&quot;</div><div class="line"></div><div class="line">@interface Dog : Anima</div><div class="line"></div><div class="line">- (instancetype)initWithKind:(NSString *)kind __attribute__((objc_designated_initializer));</div><div class="line"></div><div class="line">@end</div><div class="line"></div><div class="line">#import &quot;Dog.h&quot;</div><div class="line"></div><div class="line">@implementation Dog</div><div class="line"></div><div class="line">- (instancetype)initWithKind:(NSString *)kind</div><div class="line">&#123;</div><div class="line">    self = [super initWithName:@&quot;&quot;];</div><div class="line">    if (self) &#123;</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    return self;</div><div class="line">&#125;</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure>
<p><code>objc_designated_initializer</code>遵守原则</p>
<ul>
<li>如果该类有<code>objc_designated_initializer</code>的初始化方法，那么它必须覆盖实现父类的<code>objc_designated_initializer</code>方法，否则会有如下警告</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/2525768-098721470697ca66.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="001.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/2525768-63cb4820f332ddbc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="002.png"></p>
<p><code>Anima</code>继承自<code>NSObject</code>，而<code>init</code>为<code>NSObject</code>的<code>objc_designated_initializer</code>方法，所以会有警告信息，<code>Dog</code>一样的道理</p>
<ul>
<li>如果初始化方法拥有<code>objc_designated_initializer</code>属性，那么在使用的时候必须调用父类的<code>objc_designated_initializer</code>方法</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/2525768-bb08e13ac4da17f1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="03.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/2525768-61889649b46383ff.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="04.png"></p>
<p>在<code>Dog</code>类中的<code>objc_designated_initializer</code>方法<code>initWithKind</code>中，我们没有调用父类的<code>objc_designated_initializer</code>的方法，就得到两条警告信息</p>
<ul>
<li>如果不是<code>objc_designated_initializer</code>的初始化方法,但是该类拥有<code>objc_designated_initializer</code>初始化方法，那么，必须调用该类的<code>objc_designated_initializer</code>方法或者非<code>objc_designated_initializer</code>方法，不可以调用父类的任何初始化方法</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/2525768-62700bb1460cae13.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="05.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/2525768-1c1721a64e96a459.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="06.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/2525768-89701adff47037d1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="07.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/2525768-2e48c2e1d7eb98c0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="08.png"></p>
<p>这里我针对方法<code>3</code>进行多次修改来测试我们需要的效果，仔细看，我们会发现<code>[self init]</code>和<code>[super init]</code>两个方法，<code>[self init]</code>没有警告，为什么没有呢？因为这里实际上是在执行重新的父类的<code>init</code>方法，而<code>[super init]</code>是完全在执行父类的方法。而<code>3</code>中的最后两种方法也没有警告，正是遵循的调用该类的调用该类的<code>objc_designated_initializer</code>方法和非<code>objc_designated_initializer</code>方法</p>
<h5 id="objc-requires-super"><a href="#objc-requires-super" class="headerlink" title="objc_requires_super"></a>objc_requires_super</h5><p>此属性表示子类在重新父类方法的时候必须先执行父类的<code>super</code>方法，否则会有警告，这在我们实际工作中，很有帮助</p>
<p>例子</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">@interface Person : NSObject</div><div class="line"></div><div class="line">//表示子类在重写的时候 必须先调用父类的方法</div><div class="line">- (void)work __attribute__((objc_requires_super));</div><div class="line"></div><div class="line">@end</div><div class="line"></div><div class="line">@implementation Person</div><div class="line"></div><div class="line">- (void)work</div><div class="line">&#123;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">@end</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">#import &quot;Person.h&quot;</div><div class="line"></div><div class="line">@interface Student : Person</div><div class="line"></div><div class="line">@end</div><div class="line"></div><div class="line">@implementation Student</div><div class="line"></div><div class="line">- (void)work</div><div class="line">&#123;</div><div class="line">    </div><div class="line">&#125;</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2525768-181ef703db6d290f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="mustsuper.png"></p>
<p>从图中我们可以看到，如果不实现<code>super</code>方法，则会有警告信息</p>
<h5 id="objc-subclassing-restricted"><a href="#objc-subclassing-restricted" class="headerlink" title="objc_subclassing_restricted"></a>objc_subclassing_restricted</h5><p>有时候，我们如果不想让我们的类被其它类继承，这个时候，我们就可以用该属性来实现。我们对<code>person</code>类修改下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">__attribute__((objc_subclassing_restricted))</div><div class="line">@interface Person : NSObject</div><div class="line"></div><div class="line">//表示子类在重写的时候 必须先调用父类的方法</div><div class="line">- (void)work __attribute__((objc_requires_super));</div><div class="line"></div><div class="line">@end</div><div class="line"></div><div class="line">#import &quot;Person.h&quot;</div><div class="line"></div><div class="line">@interface Student : Person</div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/2525768-4f2aaba3673bc49c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="noreject.png"></p>
<p>从图中我们可以看到，如果我们对其进行强制继承，则会报错</p>
<h5 id="objc-runtime-name"><a href="#objc-runtime-name" class="headerlink" title="objc_runtime_name"></a>objc_runtime_name</h5><p>有时候我们不希望比人能看到我们的类的真实名字，那么就可以通过该属性来做代码混淆</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">__attribute__((objc_runtime_name(&quot;GLPerson&quot;)))</div><div class="line">@interface Person : NSObject</div><div class="line"></div><div class="line">//表示子类在重写的时候 必须先调用父类的方法</div><div class="line">- (void)work __attribute__((objc_requires_super));</div><div class="line"></div><div class="line">@end</div><div class="line"></div><div class="line"></div><div class="line">NSLog(@&quot; 打印信息:%@&quot;,NSStringFromClass([Person class]));</div><div class="line">//输出结果</div><div class="line">打印信息:GLPerson</div></pre></td></tr></table></figure>
<p>关于<code>__attribute__</code>还有许多其它属性，这里只是一些我认为常用的，通过使用这些属性，代码质量瞬间….如果有什么错误的地方，还望各位多多指点！</p>
</the></excerpt>
      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a href="/2017/08/15/iOS __attribute__那点小事/">iOS __attribute__那点小事</a></p>
        <p><span>文章作者:</span><a href="/" title="回到主页">One Dream</a></p>
        <p><span>发布时间:</span>2017-08-15, 00:00:00</p>
        <p><span>最后更新:</span>2017-08-15, 15:46:56</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/2017/08/15/iOS __attribute__那点小事/" title="iOS __attribute__那点小事">http://yoursite.com/2017/08/15/iOS __attribute__那点小事/</a>
            <span class="copy-path" data-clipboard-text="原文: http://yoursite.com/2017/08/15/iOS __attribute__那点小事/　　作者: One Dream" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target = "_blank">"署名-非商用-相同方式共享 4.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>



    <nav id="article-nav">
        
            <div id="article-nav-newer" class="article-nav-title">
                <a href="/2017/08/03/Go 语言学习之struct/">
                    Go 语言学习之struct
                </a>
            </div>
        
        
            <div id="article-nav-older" class="article-nav-title">
                <a href="/2017/08/21/iOS 关于copy与mutableCopy浅析/">
                    iOS 关于copy与mutableCopy浅析
                </a>
            </div>
        
    </nav>

  
</article>

    <div id="toc" class="toc-article">
        <strong class="toc-title">文章目录</strong>
        
            <ol class="toc"><li class="toc-item toc-level-5"><a class="toc-link" href="#关于-attribute"><span class="toc-number">1.</span> <span class="toc-text">关于 attribute</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#attribute-使用格式"><span class="toc-number">2.</span> <span class="toc-text">attribute 使用格式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#常用属性"><span class="toc-number">3.</span> <span class="toc-text">常用属性</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#具体使用"><span class="toc-number">4.</span> <span class="toc-text">具体使用</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#availability："><span class="toc-number">5.</span> <span class="toc-text">availability：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#unavailable"><span class="toc-number">6.</span> <span class="toc-text">unavailable</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#nonnull"><span class="toc-number">7.</span> <span class="toc-text">nonnull</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#cleanup"><span class="toc-number">8.</span> <span class="toc-text">cleanup</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#objc-root-class"><span class="toc-number">9.</span> <span class="toc-text">objc_root_class</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#objc-designated-initializer"><span class="toc-number">10.</span> <span class="toc-text">objc_designated_initializer</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#objc-requires-super"><span class="toc-number">11.</span> <span class="toc-text">objc_requires_super</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#objc-subclassing-restricted"><span class="toc-number">12.</span> <span class="toc-text">objc_subclassing_restricted</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#objc-runtime-name"><span class="toc-number">13.</span> <span class="toc-text">objc_runtime_name</span></a></li></ol>
        
    </div>
    <style>
        .left-col .switch-btn,
        .left-col .switch-area {
            display: none;
        }
        .toc-level-3 i,
        .toc-level-3 ol {
            display: none !important;
        }
    </style>

    <input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

    <script>
        yiliaConfig.toc = ["隐藏目录", "显示目录", !!"false"];
    </script>



    
<div class="share">
    
        <div class="bdsharebuttonbox">
            <a href="#" class="fa fa-twitter bds_twi" data-cmd="twi" title="分享到推特"></a>
            <a href="#" class="fa fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
            <a href="#" class="fa fa-qq bds_sqq" data-cmd="sqq" title="分享给 QQ 好友"></a>
            <a href="#" class="fa fa-files-o bds_copy" data-cmd="copy" title="复制网址"></a>
            <a href="#" class="fa fa fa-envelope-o bds_mail" data-cmd="mail" title="通过邮件分享"></a>
            <a href="#" class="fa fa-weixin bds_weixin" data-cmd="weixin" title="生成文章二维码"></a>
            <a href="#" class="fa fa-share-alt bds_more" data-cmd="more"></i></a>
        </div>
        <script>
            window._bd_share_config={
                "common":{"bdSnsKey":{},"bdText":"iOS __attribute__那点小事　| 半笑半醉间　","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
        </script>
    

    
</div>







    




    <div class="scroll" id="post-nav-button">
        
            <a href="/2017/08/03/Go 语言学习之struct/" title="上一篇: Go 语言学习之struct">
                <i class="fa fa-angle-left"></i>
            </a>
        

        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/2017/08/21/iOS 关于copy与mutableCopy浅析/" title="下一篇: iOS 关于copy与mutableCopy浅析">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/08/21/iOS 关于copy与mutableCopy浅析/">iOS 关于copy与mutableCopy浅析</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/15/iOS __attribute__那点小事/">iOS __attribute__那点小事</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/03/Go 语言学习之struct/">Go 语言学习之struct</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/12/Go 语言学习之函数/">Go 语言学习之函数</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/06/iOS translucent引发的那点小事/">iOS translucent引发的那点小事</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/27/iOS 自定义键盘/">iOS 自定义键盘</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/25/Go 语言学习之流程控制/">Go 语言学习之流程控制</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/23/Go 语言学习之数组 字典/">Go 语言学习之数组 字典</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/22/Go 语言基础之常量 变量/">Go 语言基础之常量 变量</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/19/Go 语言之Mac环境配置/">Go 语言之Mac环境配置</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/12/iOS CoreImage之滤镜简单使用/">iOS CoreImage之滤镜简单使用</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/24/iOS UIImage常用category/">iOS Quart2D绘图之UIImage简单使用</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/05/iOS自定义转场动画/">iOS 自定义转场动画浅谈</a></li></ul>




    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2016-2017 One Dream
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="本站到访数"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="本页阅读量"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 4;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>